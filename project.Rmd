---
title: "501-project"
output: pdf_document
date: "2022-12-18"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(rlang)
sessionInfo()
library(mosaic)
library(dplyr)
library(tidyverse)
```


## Load Data

```{r}
adult <- read.table("adult.data", sep = ",")
colnames(adult) <- c("age", "workclass", "fnlwgt", "education", "education_num", "marital_status", "occupation", "relationship", "race", "sex", "capital_gain", "capital_loss", "hours_per_week", "native_country", "fifty_k")
adult
```
```{r}
summary(adult)
```

# Test to check if average capital gain is different for Female/Male:


```{r}
# adult %>% 
#   group_by(sex) %>% 
#   summarise(record_count = n())

female <- filter(adult, str_detect(sex, 'Female'))
male <- filter(adult, str_detect(sex, 'Male'))

t.test(capital_gain ~ sex, data=adult) # Unpooled
t.test(capital_gain ~ sex, var.equal=TRUE, data=adult)   # Pooled

gain_sex<-adult %>%
  group_by(sex) %>%
  summarize(avg_captital_gain=mean(capital_gain))

gain_sex %>%
  ggplot(aes(x=sex, y=avg_captital_gain,fill=avg_captital_gain))+
  geom_tile(color="white",size=0.3)+
  scale_fill_gradient(low="blue",high="red")


```

Looking at the p value which is close to 0, we can reject the null hypothesis.
We have evidence that suggests that the true difference in means between group Female and group Male is not equal to 0.
We have evidence to say that there is a difference in the average capital gain of Male and Female

```{r}
t.test(capital_loss ~ sex, data=adult) # Unpooled
t.test(capital_loss ~ sex, var.equal=TRUE, data=adult)  # Pooled
```

# Checking if average capital gain differs by race

```{r}
# adult %>%
#   group_by(race) %>%
#   summarise(record_count = n())

anov_race <- aov(capital_gain ~ race, data = adult)
summary(anov_race)
anov_race

gain_race<-adult %>%
  group_by(race) %>%
  summarize(avg_captital_gain=mean(capital_gain))

gain_race %>%
  ggplot(aes(x=race, y=avg_captital_gain,fill=avg_captital_gain))+
  geom_tile(color="white",size=0.3)+
  scale_fill_gradient(low="blue",high="red")

```
Since the p-value in our ANOVA table (0.00132) is less than .05, we have sufficient evidence to reject the null hypothesis.

This means we have sufficient evidence to say that the mean capital gain is not equal across different races.

From the plots, we can see that the maximum average capital gain is in the race Asian-Pac-Islander.

# Checking if average capital gain differs by education level


```{r fig.width=10, fig.height=4}
# adult %>%
#   group_by(education) %>%
#   summarise(record_count = n())

anov_edu <- aov(capital_gain ~ education, data = adult)
summary(anov_edu)
anov_edu

gain_edu<-adult %>%
  group_by(education) %>%
  summarize(avg_captital_gain=mean(capital_gain))

gain_edu %>%
  ggplot(aes(x=education, y=avg_captital_gain,fill=avg_captital_gain))+
  geom_tile(color="white",size=0.3)+
  scale_fill_gradient(low="blue",high="red")

```

Since the p-value in our ANOVA table is less than .05, we have sufficient evidence to reject the null hypothesis.

This means we have sufficient evidence to say that the mean capital gain is not equal across different education levels.

From the plots, we can see that the maximum average capital gain is with the education prof school.

# Plotting gain on education and sex

```{r}
education_sex<-adult %>%
  group_by(sex, education) %>%
  summarize(avg_captital_gain=mean(capital_gain))

education_sex %>%
  ggplot(aes(x=sex,y=education,fill=avg_captital_gain))+
  geom_tile(color="white",size=0.3)+
  scale_fill_gradient(low="blue",high="red")
```

# Real Estate data set

```{r}
real_estate <- read.csv("Real_Estate.csv")
summary(real_estate)
ls(real_estate)


#xyplot(Y.house.price.of.unit.area ~ X4.number.of.convenience.stores,data=real_estate)  # positive trend
#xyplot(Y.house.price.of.unit.area ~ X3.distance.to.the.nearest.MRT.station,data=real_estate)  # negative trend


# study with distance to metro station.

#check value distribution.
histogram(~Y.house.price.of.unit.area, data=real_estate, nint=20)     

```
```{r}
pairs(real_estate[,2:8], pch=19)
```


```{r}
#check correlation between house price and distance to metro station.
cor(Y.house.price.of.unit.area ~ X3.distance.to.the.nearest.MRT.station, data=real_estate) # -0.673

#the least squares line  regression line.
m1 <- lm(Y.house.price.of.unit.area ~ X3.distance.to.the.nearest.MRT.station, data=real_estate)
summary(m1)


#xy plot
xyplot(Y.house.price.of.unit.area ~ X3.distance.to.the.nearest.MRT.station,data=real_estate,type=c("p","r"))  # negative
```




```{r}
#normalty check of errors/residual and assumptions check *

histogram(residuals(m1),width=50)
ladd(panel.qqmathline(resid(m1)))
plot(resid(m1))
plot(density(resid(m1)))
qqnorm(resid(m1))
qqline(resid(m1))
```


New analysis:

```{r}
m2 <- lm(Y.house.price.of.unit.area ~  X4.number.of.convenience.stores,  data=real_estate)
summary(m2)
```
```{r}
ggplot(real_estate, aes( X4.number.of.convenience.stores, Y.house.price.of.unit.area)) + geom_point() + stat_smooth(method = lm)
```
```{r}
histogram(residuals(m2),width=50)
ladd(panel.qqmathline(resid(m2)))
plot(resid(m2))
plot(density(resid(m2)))
qqnorm(resid(m2))
qqline(resid(m2))
```

